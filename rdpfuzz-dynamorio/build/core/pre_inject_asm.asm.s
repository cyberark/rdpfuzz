



































































































































































































































































































































   

























































  



  















































































































































































































































































































































































































































































































































































































































































































































































































































 
 
 
.CODE






EXTERN FreeLibrary:PROC
EXTERN process_attach:PROC




    




























        DllMain PROC

        cmp      rdx, 1
        jne      DllMain_not_pattach

        
        push     rcx 

        lea rsp, [-32 - 8*0 + rsp] 
 call process_attach 
 lea rsp, [32 + 8*0 + rsp]
        cmp      al, 0
        je       do_not_unload

        



        pop      rcx














        jmp      FreeLibrary

do_not_unload:
        



        mov      eax, 0

        
        pop      rcx
        ret




DllMain_not_pattach:
        mov      eax, 1

        ret



        DllMain ENDP


END
